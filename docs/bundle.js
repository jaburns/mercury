!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=8)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.width=e,this.height=t,this.vals=new Array(e*t)}return e.prototype.write=function(e,t,r){this.vals[e+t*this.width]=r},e.prototype.at=function(e,t){return this.vals[e+t*this.width]},e.prototype.copyFrom=function(e){for(var t=0;t<this.width&&t<e.width;++t)for(var r=0;r<this.height&&r<e.height;++r)this.write(t,r,e.at(t,r))},e}();t.WriteGrid=n,t.safeOutOfBounds=function(e,t){return{width:e.width,height:e.height,at:function(r,n){return r<0||n<0||r>=e.width||n>=e.width?t:e.at(r,n)}}},t.GridTool={find:function(e,t){for(var r=0;r<e.width;++r)for(var n=0;n<e.height;++n)if(t(r,n,e.at(r,n)))return{x:r,y:n};return null},forEach:function(e,t){for(var r=0;r<e.width;++r)for(var n=0;n<e.height;++n)t(r,n,e.at(r,n))},map:function(e,t){for(var r=new n(e.width,e.height),i=0;i<e.width;++i)for(var a=0;a<e.height;++a)r.write(i,a,t(i,a,e.at(i,a)));return r}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.V2={add:function(e,t){e.x+=t.x,e.y+=t.y},plus:function(e,t){return{x:e.x+t.x,y:e.y+t.y}},minus:function(e,t){return{x:e.x-t.x,y:e.y-t.y}},length:function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},scaled:function(e,t){return{x:t*e.x,y:t*e.y}}},t.RectTool={area:function(e){return(e.xmax-e.xmin)*(e.ymax-e.ymin)}},t.smallestDifferenceRadians=function(e,t){return e%=2*Math.PI,t%=2*Math.PI,Math.abs(e-t)>Math.PI&&(e>0?e-=2*Math.PI:e+=2*Math.PI),e-t},t.findBounds=function(e){var t={xmin:1/0,ymin:1/0,xmax:-1/0,ymax:-1/0};return e.forEach(function(e){e.x<t.xmin&&(t.xmin=e.x),e.y<t.ymin&&(t.ymin=e.y),e.x>t.xmax&&(t.xmax=e.x),e.y>t.ymax&&(t.ymax=e.y)}),t}},function(e,t,r){var n=r(20).Symbol;e.exports=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.loadShader=function(e,t){return fetch(t).then(function(e){if(!e.ok)throw new Error("HTTP error, status = "+e.status);return e.text()}).then(function(t){return function(e,t){var r=e.createShader(e.VERTEX_SHADER);e.shaderSource(r,"#version 300 es\n    #define VERTEX\n    #define v2f out\n    "+t+"\n"),e.compileShader(r);var n=e.getShaderInfoLog(r);if(null===n||n.length>0)return n;var i=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(i,"#version 300 es\n    #define FRAGMENT\n    #define v2f in\n    precision highp float;\n    "+t+"\n"),e.compileShader(i);var a=e.getShaderInfoLog(i);if(null===a||a.length>0)return a;var o=e.createProgram();return e.attachShader(o,r),e.attachShader(o,i),e.linkProgram(o),o}(e,t)})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(10),a=r(5),o=r(12),u=r(1),f=r(13),l=function(e,t,r,n,i,a){if(t<0||r<0)return a;if(t>=e.width||r>=e.height)return a;var o=e.at(t,r);return o===i?a:o!==n?a:(e.write(t,r,i),a=l(e,t-1,r,n,i,++a),a=l(e,t+1,r,n,i,a),a=l(e,t,r-1,n,i,a),a=l(e,t,r+1,n,i,a))};t.generateCave=function(e){return t.generateCaveVerbose(e).cave},t.generateCaveVerbose=function(e){var t,r=i.runCellularAutomaton(75,75,e.seed,.48,5,4,40),s=n.GridTool.map(r,function(e,t,r){return r?-1:0}),c=function(e){for(var t=1,r=-1,i=0;;){var a=n.GridTool.find(e,function(e,t,r){return 0===r});if(null===a)return r;var o=l(e,a.x,a.y,0,t,0);o>i&&(i=o,r=t),t++}}(s),d=n.GridTool.map(s,function(e,t,r){return r!==c});t=d,n.GridTool.forEach(n.safeOutOfBounds(t,!0),function(e,r,n){n&&(!n||t.at(e-1,r)||t.at(e+1,r)||t.write(e+1,r,!0),!n||t.at(e,r-1)||t.at(e,r+1)||t.write(e,r+1,!0))});var h=a.markEdges(d),v=a.findContours(h,e.edgePointDist),x=v.contours.map(function(e,t){return{i:t,area:u.RectTool.area(u.findBounds(e))}}).sort(function(e,t){return t.area-e.area})[0].i,y=v.contours.map(function(t){return o.smoothCurve(t,e.curveQuality,e.curveBend)}),m=y[x].map(function(e,t){return{i:t,len:(e.x+1)*(e.x+1)+(e.y+1)*(e.y+1)}}).sort(function(e,t){return e.len-t.len})[0].i,g=y[x][m],p=y[x][0===m?y[x].length-1:m-1],E=Math.abs(g.y-p.y);y[x].splice(m,0,{x:-1,y:-1+E},{x:-1,y:1},{x:1,y:1},{x:1,y:-1},{x:-1,y:-1},{x:(g.x+p.x)/2,y:(g.y+p.y)/2});var T=y.map(f.triangulate);return y[x][m].y-=E,y[x][m+5].x=p.x,y[x][m+5].y=p.y,{cave:{edges:y,triangles:T},details:{automatonResult:r,coloredGrid:s,filledGrid:d,edgeMarkedGrid:h,findContoursResult:v,outerMostContourIndex:x,topLeftMostVertexIndex:m}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(0),a=r(1);t.markEdges=function(e){for(var t=i.GridTool.map(e,function(e,t,r){return{kind:r?"dirt":"air",normal:0}}),r=0;r<e.width;r++)for(var n=0;n<e.height;n++)if(e.at(r,n)){var a=r>0&&!e.at(r-1,n),o=r<e.width-2&&!e.at(r+1,n),u=n>0&&!e.at(r,n-1),f=n<e.height-2&&!e.at(r,n+1);if(a||o||u||f){var l=o&&f?45:f&&a?135:a&&u?-135:u&&o?-45:o?0:f?90:a?180:-90;t.write(r,n,{kind:"edge",normal:l})}}return t},function(e){e[e.Unwalked=0]="Unwalked",e[e.Walked=1]="Walked",e[e.WalkedImportant=2]="WalkedImportant"}(n=t.WalkedStatus||(t.WalkedStatus={})),t.findContours=function(e,t){var r=i.GridTool.map(new i.WriteGrid(e.width,e.height),function(e){return n.Unwalked}),a=[],o=0,f=null;do{null!==(f=u(r,e,t))&&f.length>2&&a.push(f)}while(null!=f&&o++<100);return{contours:a,walkMap:r}};var o=function(e,t){for(var r=100,n=0,i=0;i<t.length;++i){var o=t[i],u=Math.abs(a.smallestDifferenceRadians(o.normal*Math.PI/180,e.normal*Math.PI/180));u<r&&(r=u,n=i)}return t[n]},u=function(e,t,r){var a=function(e,t){for(var r=0;r<t.width;r++)for(var i=0;i<t.height;i++)if("edge"===t.at(r,i).kind&&e.at(r,i)===n.Unwalked)return{x:r,y:i};return null}(e,t);if(null===a)return null;t=i.safeOutOfBounds(t,{kind:"dirt",normal:0});var u=[],f=a.x,l=a.y,s=0,c={dx:0,dy:0,normal:0},d=n.Walked,h=[];do{h=[];for(var v=-1;v<=1;v++)for(var x=-1;x<=1;x++)0===v&&0===x||"edge"===t.at(f+v,l+x).kind&&e.at(f+v,l+x)===n.Unwalked&&h.push({dx:v,dy:x,normal:t.at(f+v,l+x).normal});if(h.length>0){var y=o(c,h);f+=y.dx,l+=y.dy;var m=n.Walked;if(y.normal!==c.normal){(0===r||(1===r&&0!=y.dx&&0!=y.dy||d!=n.WalkedImportant))&&(m=n.WalkedImportant)}m===n.WalkedImportant&&u.push({x:2*(f+.5)/t.width-1,y:2*(l+.5)/t.height-1}),e.write(f,l,m),d=m,c=y}}while(h.length>0&&s++<5e3);return u}},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,r){this.gl=e,this._framebuffer=e.createFramebuffer(),e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer),this._texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this._texture),e.texImage2D(e.TEXTURE_2D,0,e.RGB,t,r,0,e.RGB,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._texture,0)}return Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"framebuffer",{get:function(){return this._framebuffer},enumerable:!0,configurable:!0}),e.prototype.delete=function(){var e=this.gl;e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(this._texture),e.deleteFramebuffer(this._framebuffer)},e}();t.FrameBufferTexture=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(9),i=r(14),a={"vector-caves":n.initPost,"page2-webgl":i.initPost};window.initPost=function(e){return a[e]()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),i=r(0),a=r(5),o=function(){var e=function(){var e=Math.floor(256*Math.random()).toString(16);return e.length<2&&(e="0"+e),e};return"#"+e()+e()+e()},u=[0,0,0,0,0,0,0,0,0,0].map(function(e){return o()});t.initPost=function(){var e,t,r=document.getElementById("first-canvas").getContext("2d"),f=document.getElementById("seed-slider"),l=document.getElementById("insurance-slider"),s=document.getElementById("curviness-slider"),c=document.getElementById("quality-slider"),d=document.getElementById("second-canvas").getContext("2d"),h=document.getElementById("third-canvas").getContext("2d"),v=document.getElementById("fourth-canvas").getContext("2d"),x=document.getElementById("fifth-canvas").getContext("2d"),y=document.getElementById("sixth-canvas").getContext("2d"),m=document.getElementById("seventh-canvas").getContext("2d"),g=document.getElementById("ninth-canvas").getContext("2d"),p=function(){var e={seed:parseInt(f.value),edgePointDist:parseInt(l.value),curveBend:2*parseFloat(s.value)/100,curveQuality:parseFloat(c.value)},t=n.generateCaveVerbose(e),p=t.cave,E=t.details;i.GridTool.forEach(E.automatonResult,function(e,t,n){r.fillStyle=n?"#000":"#FFF",r.fillRect(4*e,4*t,4,4)}),i.GridTool.forEach(E.coloredGrid,function(e,t,r){var n;d.fillStyle=(n=r)<0?"#000":u[n%u.length],d.fillRect(4*e,4*t,4,4)}),i.GridTool.forEach(E.filledGrid,function(e,t,r){h.fillStyle=r?"#000":"#FFF",h.fillRect(4*e,4*t,4,4)}),i.GridTool.forEach(E.edgeMarkedGrid,function(e,t,r){v.fillStyle="edge"===r.kind?function(e){var t=Math.cos(e*Math.PI/180),r=Math.sin(e*Math.PI/180),n=Math.round(15*(.5*t+.5)),i=Math.round(15*(.5*r+.5));return"#"+n.toString(16)+i.toString(16)+"f"}(r.normal):"air"===r.kind?"#655":"#77f",v.fillRect(4*e,4*t,4,4)});var T=E.findContoursResult;i.GridTool.forEach(T.walkMap,function(e,t,r){x.fillStyle=r===a.WalkedStatus.WalkedImportant?"#fff":r===a.WalkedStatus.Walked?"#333":"#000",x.fillRect(4*e,4*t,4,4),y.fillStyle=r===a.WalkedStatus.WalkedImportant?"#333":"#000",y.fillRect(9*e,9*t,9,9)});var b=function(e){return{x:337.5*(1+e.x),y:337.5*(1+e.y)}};T.contours.forEach(function(e,t){y.strokeStyle=t===E.outerMostContourIndex?"#f00":"#933",y.beginPath();var r=b(e[0]);y.moveTo(r.x,r.y);for(var n=1;n<e.length;++n){var i=b(e[n]);y.lineTo(i.x,i.y)}y.closePath(),y.stroke()}),m.strokeStyle="#0f0",m.fillStyle="#000",m.fillRect(0,0,675,675),p.edges.forEach(function(e,t){m.strokeStyle=t===E.outerMostContourIndex?"#0f0":"#393",m.beginPath();var r=b(e[0]);m.moveTo(r.x,r.y);for(var n=1;n<e.length;++n){var i=b(e[n]);m.lineTo(i.x,i.y)}m.closePath(),m.stroke()}),g.fillStyle="#000",g.fillRect(0,0,675,675),p.triangles.forEach(function(e,t){for(var r=function(r){g.fillStyle=o(),g.beginPath();var n=b(p.edges[t][e[r]]);g.moveTo(n.x,n.y),[1,2,0].forEach(function(n){var i=b(p.edges[t][e[r+n]]);g.lineTo(i.x,i.y)}),g.fill()},n=0;n<e.length-2;n+=3)r(n)})};e=["oninput","onchange"],t=p,[f,l,s,c].forEach(function(r){e.forEach(function(e){r[e]=t})}),p()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(11),i=r(0),a=function(e,t,r){for(var n=0,i=t-1;i<=t+1;++i)for(var a=r-1;a<=r+1;++a)i==t&&a==r||(i<1||a<1||i>=e.width-1||a>=e.height-1?n++:n+=e.at(i,a)?1:0);return n};t.runCellularAutomaton=function(e,t,r,o,u,f,l){for(var s=new i.WriteGrid(e,t),c=new i.WriteGrid(e,t),d=n.nextRandom01(r/101),h=0;h<e;++h)for(var v=0;v<t;++v){var x=0===h||0===v||h===e-1||v===t-1||d<o;s.write(h,v,x),c.write(h,v,x),d=n.nextRandom01(d)}for(var y=0;y<l;++y){for(h=1;h<e-1;++h)for(v=1;v<t-1;++v){var m=a(s,h,v);c.write(h,v,m>=(s.at(h,v)?f:u))}s.copyFrom(c)}return s}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=4294967296;t.nextRandom01=function(e){return(1664525*Math.floor(e*n)+1013904223)%n/n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);t.smoothCurve=function(e,t,r){var i=[];t<1&&(t=1);for(var a=0;a<e.length;++a){var o=e[0==a?e.length-1:a-1],u=e[a],f=e[(a+1)%e.length],l=n.V2.length(n.V2.minus(o,u)),s=n.V2.length(n.V2.minus(u,f)),c=n.V2.scaled(n.V2.plus(o,u),.5),d=n.V2.scaled(n.V2.plus(u,f),.5),h=n.V2.scaled(n.V2.minus(c,d),r),v=n.V2.scaled(h,l/(l+s)),x=n.V2.scaled(h,-s/(l+s));i.push({pt:u,controlA:n.V2.plus(u,v),controlB:n.V2.plus(u,x)})}var y=1/t,m=[];for(a=0;a<i.length;++a){u=i[a],f=i[(a+1)%i.length];for(var g=0;g<1-y/2;g+=y){var p={x:0,y:0};n.V2.add(p,n.V2.scaled(u.pt,(1-g)*(1-g)*(1-g))),n.V2.add(p,n.V2.scaled(u.controlB,3*(1-g)*(1-g)*g)),n.V2.add(p,n.V2.scaled(f.controlA,3*(1-g)*g*g)),n.V2.add(p,n.V2.scaled(f.pt,g*g*g)),m.push(p)}}return m}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.triangulate=function(e){var t=[],r=e.length;if(r<3)return t;var i=new Array(r);if(n(e)>0)for(var o=0;o<r;o++)i[o]=o;else for(o=0;o<r;o++)i[o]=r-1-o;var u=r,f=2*u;for(o=u-1;u>2;){if(f--<=0)return t;var l=o;u<=l&&(l=0),u<=(o=l+1)&&(o=0);var s=o+1;if(u<=s&&(s=0),a(e,l,o,s,u,i)){t.push(i[l]),t.push(i[o]),t.push(i[s]);for(var c=o,d=o+1;d<u;c++,d++)i[c]=i[d];f=2*--u}}return t};var n=function(e){for(var t=0,r=e.length-1,n=0;n<e.length;r=n++)t+=e[r].x*e[n].y-e[n].x*e[r].y;return t/2},i=function(e,t,r,n){var i=r.x-t.x,a=r.y-t.y,o=e.x-r.x,u=e.y-r.y,f=t.x-e.x,l=t.y-e.y,s=n.x-e.x,c=n.y-e.y,d=n.x-t.x,h=n.y-t.y,v=n.x-r.x,x=n.y-r.y;return i*h-a*d>=0&&o*x-u*v>=0&&f*c-l*s>=0},a=function(e,t,r,n,a,o){var u=e[o[t]],f=e[o[r]],l=e[o[n]];if((f.x-u.x)*(l.y-u.y)-(f.y-u.y)*(l.x-u.x)<1e-7)return!1;for(var s=0;s<a;s++)if(s!=t&&s!=r&&s!=n){var c=e[o[s]];if(i(u,f,l,c))return!1}return!0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),i=r(15),a=r(7),o=r(29),u=r(30);t.initPost=function(){var e=document.getElementById("first-canvas"),t=e.getContext("webgl2"),r=n.generateCave({seed:.1247,curveBend:.75,curveQuality:10,edgePointDist:2}),f=new a.FrameBufferTexture(t,1024,1024);Promise.all([i.CaveRenderer.create(t,r),o.FullScreenBlitter.create(t),u.GaussianBlur.create(t,1024,1024)]).then(function(r){var n=r[0],i=r[1],a=r[2];t.bindFramebuffer(t.FRAMEBUFFER,f.framebuffer),t.viewport(0,0,1024,1024),t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),n.draw(),a.run(f.texture,30),t.bindFramebuffer(t.FRAMEBUFFER,f.framebuffer),t.viewport(0,0,1024,1024),i.drawWithNormals(a.resultTexture),a.run(f.texture,2),t.bindFramebuffer(t.FRAMEBUFFER,null),t.viewport(0,0,e.width,e.height),i.draw(a.resultTexture)})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(16),i=r(3),a=function(e){return n(n(e.edges).map(function(e){return[e.x,e.y]}))},o=function(e){var t=0,r=[];return e.triangles.forEach(function(n,i){r=r.concat(n.map(function(e){return e+t})),t+=e.edges[i].length}),r},u=function(){function e(e,t,r){this.gl=e,this.shader=r,this.vao=e.createVertexArray(),e.bindVertexArray(this.vao),this.vertexBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(a(t)),e.STATIC_DRAW),e.enableVertexAttribArray(0),e.vertexAttribPointer(0,2,e.FLOAT,!1,0,0);var n=o(t);this.indexBufferLen=n.length,this.indexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(n),e.STATIC_DRAW)}return e.create=function(t,r){return i.loadShader(t,"shaders/flatWhite.glsl").then(function(n){return new e(t,r,n)})},e.prototype.draw=function(){var e=this.gl;e.bindVertexArray(this.vao),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.useProgram(this.shader),e.drawElements(e.TRIANGLES,this.indexBufferLen,e.UNSIGNED_SHORT,0)},e.prototype.delete=function(){var e=this.gl;e.bindVertexArray(null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.bindBuffer(e.ARRAY_BUFFER,null),e.deleteBuffer(this.vertexBuffer),e.deleteBuffer(this.indexBuffer),e.deleteVertexArray(this.vao)},e}();t.CaveRenderer=u},function(e,t,r){var n=r(17);e.exports=function(e){return null!=e&&e.length?n(e,1):[]}},function(e,t,r){var n=r(18),i=r(19);e.exports=function e(t,r,a,o,u){var f=-1,l=t.length;for(a||(a=i),u||(u=[]);++f<l;){var s=t[f];r>0&&a(s)?r>1?e(s,r-1,a,o,u):n(u,s):o||(u[u.length]=s)}return u}},function(e,t){e.exports=function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}},function(e,t,r){var n=r(2),i=r(23),a=r(28),o=n?n.isConcatSpreadable:void 0;e.exports=function(e){return a(e)||i(e)||!!(o&&e&&e[o])}},function(e,t,r){var n=r(21),i="object"==typeof self&&self&&self.Object===Object&&self,a=n||i||Function("return this")();e.exports=a},function(e,t,r){(function(t){var r="object"==typeof t&&t&&t.Object===Object&&t;e.exports=r}).call(this,r(22))},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){var n=r(24),i=r(6),a=Object.prototype,o=a.hasOwnProperty,u=a.propertyIsEnumerable,f=n(function(){return arguments}())?n:function(e){return i(e)&&o.call(e,"callee")&&!u.call(e,"callee")};e.exports=f},function(e,t,r){var n=r(25),i=r(6),a="[object Arguments]";e.exports=function(e){return i(e)&&n(e)==a}},function(e,t,r){var n=r(2),i=r(26),a=r(27),o="[object Null]",u="[object Undefined]",f=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?u:o:f&&f in Object(e)?i(e):a(e)}},function(e,t,r){var n=r(2),i=Object.prototype,a=i.hasOwnProperty,o=i.toString,u=n?n.toStringTag:void 0;e.exports=function(e){var t=a.call(e,u),r=e[u];try{e[u]=void 0;var n=!0}catch(e){}var i=o.call(e);return n&&(t?e[u]=r:delete e[u]),i}},function(e,t){var r=Object.prototype.toString;e.exports=function(e){return r.call(e)}},function(e,t){var r=Array.isArray;e.exports=r},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=function(){function e(e,t,r){this.gl=e,this.shader=t,this.shader2=r,this.vao=e.createVertexArray(),e.bindVertexArray(this.vao),this.vertexBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,1,-1,-1,1,-1,1,-1,1,1,-1,1]),e.STATIC_DRAW),e.enableVertexAttribArray(0),e.vertexAttribPointer(0,2,e.FLOAT,!1,0,0)}return e.create=function(t){return Promise.all([n.loadShader(t,"shaders/fullScreenBlit.glsl"),n.loadShader(t,"shaders/normals.glsl")]).then(function(r){var n=r[0],i=r[1];return new e(t,n,i)})},e.prototype.drawWithNormals=function(e){var t=this.gl;t.bindVertexArray(this.vao),t.useProgram(this.shader2),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,e);var r=t.getUniformLocation(this.shader2,"u_tex");t.uniform1i(r,0),t.uniform2f(t.getUniformLocation(this.shader2,"u_resolution"),1024,1024),t.drawArrays(t.TRIANGLES,0,6)},e.prototype.draw=function(e){var t=this.gl;t.bindVertexArray(this.vao),t.useProgram(this.shader),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,e);var r=t.getUniformLocation(this.shader,"u_tex");t.uniform1i(r,0),t.uniform2f(t.getUniformLocation(this.shader,"u_resolution"),1024,1024),t.drawArrays(t.TRIANGLES,0,6)},e}();t.FullScreenBlitter=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=r(7),a=function(){function e(e,t,r,n){this.gl=e,this.shader=n,this.width=t,this.height=r,this.vao=e.createVertexArray(),e.bindVertexArray(this.vao),this.vertexBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,1,-1,-1,1,-1,1,-1,1,1,-1,1]),e.STATIC_DRAW),e.enableVertexAttribArray(0),e.vertexAttribPointer(0,2,e.FLOAT,!1,0,0),this.frameTex0=new i.FrameBufferTexture(e,t,r),this.frameTex1=new i.FrameBufferTexture(e,t,r)}return e.create=function(t,r,i){return n.loadShader(t,"shaders/gaussianBlur.glsl").then(function(n){return new e(t,r,i,n)})},e.prototype.run=function(e,t){var r=this.gl;t<1&&(t=1),r.bindVertexArray(this.vao),r.useProgram(this.shader);for(var n=r.getUniformLocation(this.shader,"u_tex"),i=0;i<t;++i)r.bindFramebuffer(r.FRAMEBUFFER,this.frameTex0.framebuffer),0===i&&r.viewport(0,0,this.width,this.height),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,0===i?e:this.frameTex1.texture),r.uniform1i(n,0),r.uniform2f(r.getUniformLocation(this.shader,"u_resolution"),this.width,this.height),r.uniform2f(r.getUniformLocation(this.shader,"u_direction"),1,0),r.drawArrays(r.TRIANGLES,0,6),r.bindFramebuffer(r.FRAMEBUFFER,this.frameTex1.framebuffer),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,this.frameTex0.texture),r.uniform1i(n,0),r.uniform2f(r.getUniformLocation(this.shader,"u_direction"),0,1),r.drawArrays(r.TRIANGLES,0,6)},Object.defineProperty(e.prototype,"resultTexture",{get:function(){return this.frameTex1.texture},enumerable:!0,configurable:!0}),e}();t.GaussianBlur=a}]);
//# sourceMappingURL=bundle.js.map