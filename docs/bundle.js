!function(t){var e={};function r(n){if(e[n])return e[n].exports;var a=e[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(n,a,function(e){return t[e]}.bind(null,a));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=2)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){this.width=t,this.height=e,this.vals=new Array(t*e)}return t.prototype.write=function(t,e,r){this.vals[t+e*this.width]=r},t.prototype.at=function(t,e){return this.vals[t+e*this.width]},t.prototype.copyFrom=function(t){for(var e=0;e<this.width&&e<t.width;++e)for(var r=0;r<this.height&&r<t.height;++r)this.write(e,r,t.at(e,r))},t}();e.WriteGrid=n,e.safeOutOfBounds=function(t,e){return{width:t.width,height:t.height,at:function(r,n){return r<0||n<0||r>=t.width||n>=t.width?e:t.at(r,n)}}},e.GridTool={find:function(t,e){for(var r=0;r<t.width;++r)for(var n=0;n<t.height;++n)if(e(r,n,t.at(r,n)))return{x:r,y:n};return null},forEach:function(t,e){for(var r=0;r<t.width;++r)for(var n=0;n<t.height;++n)e(r,n,t.at(r,n))},map:function(t,e){for(var r=new n(t.width,t.height),a=0;a<t.width;++a)for(var i=0;i<t.height;++i)r.write(a,i,e(a,i,t.at(a,i)));return r}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.V2={add:function(t,e){t.x+=e.x,t.y+=e.y},plus:function(t,e){return{x:t.x+e.x,y:t.y+e.y}},minus:function(t,e){return{x:t.x-e.x,y:t.y-e.y}},length:function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},scaled:function(t,e){return{x:e*t.x,y:e*t.y}}},e.RectTool={area:function(t){return(t.xmax-t.xmin)*(t.ymax-t.ymin)}},e.smallestDifferenceRadians=function(t,e){return t%=2*Math.PI,e%=2*Math.PI,Math.abs(t-e)>Math.PI&&(t>0?t-=2*Math.PI:t+=2*Math.PI),t-e},e.findBounds=function(t){var e={xmin:1/0,ymin:1/0,xmax:-1/0,ymax:-1/0};return t.forEach(function(t){t.x<e.xmin&&(e.xmin=t.x),t.y<e.ymin&&(e.ymin=t.y),t.x>e.xmax&&(e.xmax=t.x),t.y>e.ymax&&(e.ymax=t.y)}),e}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(3),a=r(9),i={"vector-caves":n.initPost,"page2-webgl":a.initPost};window.initPost=function(t){return i[t]()}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}(r(11))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(5),a=r(0),i=function(t,e,r){for(var n=0,a=e-1;a<=e+1;++a)for(var i=r-1;i<=r+1;++i)a==e&&i==r||(a<1||i<1||a>=t.width-1||i>=t.height-1?n++:n+=t.at(a,i)?1:0);return n};e.runCellularAutomaton=function(t,e,r,o,l,u,f){for(var d=new a.WriteGrid(t,e),h=new a.WriteGrid(t,e),c=n.nextRandom01(r/101),s=0;s<t;++s)for(var y=0;y<e;++y){var v=0===s||0===y||s===t-1||y===e-1||c<o;d.write(s,y,v),h.write(s,y,v),c=n.nextRandom01(c)}for(var p=0;p<f;++p){for(s=1;s<t-1;++s)for(y=1;y<e-1;++y){var g=i(d,s,y);h.write(s,y,g>=(d.at(s,y)?u:l))}d.copyFrom(h)}return d}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=4294967296;e.nextRandom01=function(t){return(1664525*Math.floor(t*n)+1013904223)%n/n}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,a=r(0),i=r(1);e.markEdges=function(t){for(var e=a.GridTool.map(t,function(t,e,r){return{kind:r?"dirt":"air",normal:0}}),r=0;r<t.width;r++)for(var n=0;n<t.height;n++)if(t.at(r,n)){var i=r>0&&!t.at(r-1,n),o=r<t.width-2&&!t.at(r+1,n),l=n>0&&!t.at(r,n-1),u=n<t.height-2&&!t.at(r,n+1);if(i||o||l||u){var f=o&&u?45:u&&i?135:i&&l?-135:l&&o?-45:o?0:u?90:i?180:-90;e.write(r,n,{kind:"edge",normal:f})}}return e},function(t){t[t.Unwalked=0]="Unwalked",t[t.Walked=1]="Walked",t[t.WalkedImportant=2]="WalkedImportant"}(n=e.WalkedStatus||(e.WalkedStatus={})),e.findContours=function(t,e){var r=a.GridTool.map(new a.WriteGrid(t.width,t.height),function(t){return n.Unwalked}),i=[],o=0,u=null;do{null!==(u=l(r,t,e))&&u.length>2&&i.push(u)}while(null!=u&&o++<100);return{contours:i,walkMap:r}};var o=function(t,e){for(var r=100,n=0,a=0;a<e.length;++a){var o=e[a],l=Math.abs(i.smallestDifferenceRadians(o.normal*Math.PI/180,t.normal*Math.PI/180));l<r&&(r=l,n=a)}return e[n]},l=function(t,e,r){var i=function(t,e){for(var r=0;r<e.width;r++)for(var a=0;a<e.height;a++)if("edge"===e.at(r,a).kind&&t.at(r,a)===n.Unwalked)return{x:r,y:a};return null}(t,e);if(null===i)return null;e=a.safeOutOfBounds(e,{kind:"dirt",normal:0});var l=[],u=i.x,f=i.y,d=0,h={dx:0,dy:0,normal:0},c=n.Walked,s=[];do{s=[];for(var y=-1;y<=1;y++)for(var v=-1;v<=1;v++)0===y&&0===v||"edge"===e.at(u+y,f+v).kind&&t.at(u+y,f+v)===n.Unwalked&&s.push({dx:y,dy:v,normal:e.at(u+y,f+v).normal});if(s.length>0){var p=o(h,s);u+=p.dx,f+=p.dy;var g=n.Walked;if(p.normal!==h.normal){(0===r||(1===r&&0!=p.dx&&0!=p.dy||c!=n.WalkedImportant))&&(g=n.WalkedImportant)}g===n.WalkedImportant&&l.push({x:(u+.5)/e.width-.5,y:(f+.5)/e.height-.5}),t.write(u,f,g),c=g,h=p}}while(s.length>0&&d++<5e3);return l}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1);e.smoothCurve=function(t,e,r){var a=[];e<1&&(e=1);for(var i=0;i<t.length;++i){var o=t[0==i?t.length-1:i-1],l=t[i],u=t[(i+1)%t.length],f=n.V2.length(n.V2.minus(o,l)),d=n.V2.length(n.V2.minus(l,u)),h=n.V2.scaled(n.V2.plus(o,l),.5),c=n.V2.scaled(n.V2.plus(l,u),.5),s=n.V2.scaled(n.V2.minus(h,c),r),y=n.V2.scaled(s,f/(f+d)),v=n.V2.scaled(s,-d/(f+d));a.push({pt:l,controlA:n.V2.plus(l,y),controlB:n.V2.plus(l,v)})}var p=1/e,g=[];for(i=0;i<a.length;++i){l=a[i],u=a[(i+1)%a.length];for(var w=0;w<1-p/2;w+=p){var x={x:0,y:0};n.V2.add(x,n.V2.scaled(l.pt,(1-w)*(1-w)*(1-w))),n.V2.add(x,n.V2.scaled(l.controlB,3*(1-w)*(1-w)*w)),n.V2.add(x,n.V2.scaled(u.controlA,3*(1-w)*w*w)),n.V2.add(x,n.V2.scaled(u.pt,w*w*w)),g.push(x)}}return g}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.triangulate=function(t){var e=[],r=t.length;if(r<3)return e;var a=new Array(r);if(n(t)>0)for(var o=0;o<r;o++)a[o]=o;else for(o=0;o<r;o++)a[o]=r-1-o;var l=r,u=2*l;for(o=l-1;l>2;){if(u--<=0)return e;var f=o;l<=f&&(f=0),l<=(o=f+1)&&(o=0);var d=o+1;if(l<=d&&(d=0),i(t,f,o,d,l,a)){e.push(a[f]),e.push(a[o]),e.push(a[d]);for(var h=o,c=o+1;c<l;h++,c++)a[h]=a[c];u=2*--l}}return e};var n=function(t){for(var e=0,r=t.length-1,n=0;n<t.length;r=n++)e+=t[r].x*t[n].y-t[n].x*t[r].y;return e/2},a=function(t,e,r,n){var a=r.x-e.x,i=r.y-e.y,o=t.x-r.x,l=t.y-r.y,u=e.x-t.x,f=e.y-t.y,d=n.x-t.x,h=n.y-t.y,c=n.x-e.x,s=n.y-e.y,y=n.x-r.x,v=n.y-r.y;return a*s-i*c>=0&&o*v-l*y>=0&&u*h-f*d>=0},i=function(t,e,r,n,i,o){var l=t[o[e]],u=t[o[r]],f=t[o[n]];if((u.x-l.x)*(f.y-l.y)-(u.y-l.y)*(f.x-l.x)<1e-7)return!1;for(var d=0;d<i;d++)if(d!=e&&d!=r&&d!=n){var h=t[o[d]];if(a(l,u,f,h))return!1}return!0}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(10);e.initPost=function(){var t=document.getElementById("first-canvas"),e=t.getContext("webgl2");e.viewport(0,0,t.width,t.height),e.cullFace(e.BACK),Promise.all([n.loadShader(e,"/shaders/purple.glsl"),n.loadShader(e,"/shaders/bufferCopy.glsl")]).then(function(r){var n=r[0],a=r[1];if("string"!=typeof n&&"string"!=typeof a){var i=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,i);var o=e.createTexture();e.bindTexture(e.TEXTURE_2D,o),e.texImage2D(e.TEXTURE_2D,0,e.RGB,t.width,t.height,0,e.RGB,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,o,0),e.clearColor(0,1,0,1),e.clear(e.COLOR_BUFFER_BIT);var l=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,l),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-.95,.95,0,-.95,-.95,0,.95,-.95,0,.9,0,0,.9,.9,0,0,.9,0]),e.STATIC_DRAW),e.useProgram(n);var u=e.getAttribLocation(n,"c");e.vertexAttribPointer(u,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(u),e.drawArrays(e.TRIANGLES,0,6),e.bindFramebuffer(e.FRAMEBUFFER,null);l=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,l),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,1,0,-1,-1,0,1,-1,0,1,-1,0,1,1,0,-1,1,0]),e.STATIC_DRAW),e.useProgram(a);u=e.getAttribLocation(a,"c");e.vertexAttribPointer(u,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(u),e.drawArrays(e.TRIANGLES,0,6)}else console.log("Shader error: "+n+a)})}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.loadShader=function(t,e){return fetch(e).then(function(t){if(!t.ok)throw new Error("HTTP error, status = "+t.status);return t.text()}).then(function(e){return function(t,e){var r=t.createShader(t.VERTEX_SHADER);t.shaderSource(r,"#version 300 es\n    #define VERTEX\n    #define v2f out\n    "+e+"\n"),t.compileShader(r);var n=t.getShaderInfoLog(r);if(null===n||n.length>0)return n;var a=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(a,"#version 300 es\n    #define FRAGMENT\n    #define v2f in\n    precision highp float;\n    "+e+"\n"),t.compileShader(a);var i=t.getShaderInfoLog(a);if(null===i||i.length>0)return i;var o=t.createProgram();return t.attachShader(o,r),t.attachShader(o,a),t.linkProgram(o),o}(t,e)})}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(0),a=r(4),i=r(6),o=r(7),l=r(1),u=r(8),f=function(t,e,r,n,a,i){if(e<0||r<0)return i;if(e>=t.width||r>=t.height)return i;var o=t.at(e,r);return o===a?i:o!==n?i:(t.write(e,r,a),i=f(t,e-1,r,n,a,++i),i=f(t,e+1,r,n,a,i),i=f(t,e,r-1,n,a,i),i=f(t,e,r+1,n,a,i))},d=function(){var t=function(){var t=Math.floor(256*Math.random()).toString(16);return t.length<2&&(t="0"+t),t};return"#"+t()+t()+t()},h=[0,0,0,0,0,0,0,0,0,0].map(function(t){return d()});e.initPost=function(){var t,e,r=document.getElementById("first-canvas").getContext("2d"),c=document.getElementById("seed-slider"),s=document.getElementById("pop-slider"),y=document.getElementById("gen-slider"),v=document.getElementById("insurance-slider"),p=document.getElementById("curviness-slider"),g=document.getElementById("quality-slider"),w=document.getElementById("second-canvas").getContext("2d"),x=document.getElementById("third-canvas").getContext("2d"),m=document.getElementById("fourth-canvas").getContext("2d"),M=document.getElementById("fifth-canvas").getContext("2d"),k=document.getElementById("sixth-canvas").getContext("2d"),E=document.getElementById("seventh-canvas").getContext("2d"),T=document.getElementById("eighth-canvas").getContext("2d"),R=document.getElementById("ninth-canvas").getContext("2d"),b=function(){var t=a.runCellularAutomaton(75,75,parseInt(c.value),parseFloat(s.value),5,4,parseInt(y.value));n.GridTool.forEach(t,function(t,e,n){r.fillStyle=n?"#000":"#FFF",r.fillRect(4*t,4*e,4,4)});var e=n.GridTool.map(t,function(t,e,r){return r?-1:0}),b=function(t){for(var e=1,r=-1,a=0;;){var i=n.GridTool.find(t,function(t,e,r){return 0===r});if(null===i)return r;var o=f(t,i.x,i.y,0,e,0);o>a&&(a=o,r=e),e++}}(e);n.GridTool.forEach(e,function(t,e,r){var n;w.fillStyle=(n=r)<0?"#000":h[n%h.length],w.fillRect(4*t,4*e,4,4)});var _=n.GridTool.map(e,function(t,e,r){return r!==b});!function(t){n.GridTool.forEach(n.safeOutOfBounds(t,!0),function(e,r,n){n&&(!n||t.at(e-1,r)||t.at(e+1,r)||t.write(e+1,r,!0),!n||t.at(e,r-1)||t.at(e,r+1)||t.write(e,r+1,!0))})}(_),n.GridTool.forEach(_,function(t,e,r){x.fillStyle=r?"#000":"#FFF",x.fillRect(4*t,4*e,4,4)});var I=i.markEdges(_);n.GridTool.forEach(I,function(t,e,r){m.fillStyle="edge"===r.kind?function(t){var e=Math.cos(t*Math.PI/180),r=Math.sin(t*Math.PI/180),n=Math.round(15*(.5*e+.5)),a=Math.round(15*(.5*r+.5));return"#"+n.toString(16)+a.toString(16)+"f"}(r.normal):"air"===r.kind?"#655":"#77f",m.fillRect(4*t,4*e,4,4)});var S=i.findContours(I,parseInt(v.value));n.GridTool.forEach(S.walkMap,function(t,e,r){M.fillStyle=r===i.WalkedStatus.WalkedImportant?"#fff":r===i.WalkedStatus.Walked?"#333":"#000",M.fillRect(4*t,4*e,4,4),k.fillStyle=r===i.WalkedStatus.WalkedImportant?"#333":"#000",k.fillRect(9*t,9*e,9,9)});var P=S.contours.map(function(t,e){return{i:e,area:l.RectTool.area(l.findBounds(t))}}).sort(function(t,e){return e.area-t.area})[0].i;S.contours.forEach(function(t,e){k.strokeStyle=e===P?"#f00":"#933";for(var r=0;r<t.length;++r){var n=(r+1)%t.length,a={x:9*S.walkMap.width*t[r].x,y:9*S.walkMap.height*t[r].y},i={x:9*S.walkMap.width*t[n].x,y:9*S.walkMap.height*t[n].y};k.beginPath(),k.moveTo(9*S.walkMap.width/2+a.x,9*S.walkMap.height/2+a.y),k.lineTo(9*S.walkMap.width/2+i.x,9*S.walkMap.height/2+i.y),k.stroke()}});var A=S.contours.map(function(t){return o.smoothCurve(t,parseFloat(g.value),2*parseFloat(p.value)/100)});E.strokeStyle="#0f0",E.fillStyle="#000",E.fillRect(0,0,675,675),A.forEach(function(t,e){E.strokeStyle=e===P?"#0f0":"#393";for(var r=0;r<t.length;++r){var n=(r+1)%t.length,a={x:9*S.walkMap.width*t[r].x,y:9*S.walkMap.height*t[r].y},i={x:9*S.walkMap.width*t[n].x,y:9*S.walkMap.height*t[n].y};E.beginPath(),E.moveTo(9*S.walkMap.width/2+a.x,9*S.walkMap.height/2+a.y),E.lineTo(9*S.walkMap.width/2+i.x,9*S.walkMap.height/2+i.y),E.stroke()}});var F=A[P].map(function(t,e){return{i:e,len:(t.x+.5)*(t.x+.5)+(t.y+.5)*(t.y+.5)}}).sort(function(t,e){return t.len-e.len})[0].i,B=A[P][F],O=A[P][0===F?A[P].length-1:F-1];E.strokeStyle="#0f0",E.beginPath(),E.moveTo(9*S.walkMap.width/2+9*S.walkMap.width*B.x,9*S.walkMap.height/2+9*S.walkMap.height*B.y),E.lineTo(-9*S.walkMap.width/2,-9*S.walkMap.height/2),E.stroke(),E.strokeStyle="#9f9",E.beginPath(),E.arc(9*S.walkMap.width/2+9*S.walkMap.width*B.x,9*S.walkMap.height/2+9*S.walkMap.height*B.y,5,0,2*Math.PI),E.stroke();var V=Math.abs(B.y-O.y);A[P].splice(F,0,{x:-.51,y:-.51+V},{x:-.51,y:.51},{x:.51,y:.51},{x:.51,y:-.51},{x:-.51,y:-.51},{x:(B.x+O.x)/2,y:(B.y+O.y)/2});var C=A.map(u.triangulate);A[P][F].y-=V,A[P][F+5].x=O.x,A[P][F+5].y=O.y,T.fillStyle="#000",T.fillRect(0,0,675,675),A.forEach(function(t,e){T.fillStyle=e===P?"#0f0":"#393",T.beginPath();var r=9*S.walkMap.width*t[0].x,n=9*S.walkMap.height*t[0].y;T.moveTo(9*S.walkMap.width/2+r,9*S.walkMap.height/2+n);for(var a=1;a<t.length;++a){var i={x:9*S.walkMap.width*t[a].x,y:9*S.walkMap.height*t[a].y};T.lineTo(9*S.walkMap.width/2+i.x,9*S.walkMap.height/2+i.y)}T.fill()}),R.fillStyle="#000",R.fillRect(0,0,675,675),C.forEach(function(t,e){for(var r=0;r<t.length-2;r+=3){R.fillStyle=d(),R.beginPath();var n=A[e][t[r]],a={x:8*S.walkMap.width*n.x,y:8*S.walkMap.height*n.y};R.moveTo(9*S.walkMap.width/2+a.x,9*S.walkMap.height/2+a.y);n=A[e][t[r+1]],a={x:8*S.walkMap.width*n.x,y:8*S.walkMap.height*n.y};R.lineTo(9*S.walkMap.width/2+a.x,9*S.walkMap.height/2+a.y);n=A[e][t[r+2]],a={x:8*S.walkMap.width*n.x,y:8*S.walkMap.height*n.y};R.lineTo(9*S.walkMap.width/2+a.x,9*S.walkMap.height/2+a.y);n=A[e][t[r]],a={x:8*S.walkMap.width*n.x,y:8*S.walkMap.height*n.y};R.lineTo(9*S.walkMap.width/2+a.x,9*S.walkMap.height/2+a.y),R.fill()}})};t=["oninput","onchange"],e=b,[s,y,c,v,p,g].forEach(function(r){t.forEach(function(t){r[t]=e})}),b()}}]);
//# sourceMappingURL=bundle.js.map